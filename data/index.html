<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GEE and Data &mdash; rabpro  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Basic example" href="../examples/notebooks/basic_example.html" />
    <link rel="prev" title="Background" href="../background/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> rabpro
            <img src="../_static/logo_small.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/index.html">Background</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">GEE and Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#google-earth-engine-gee">Google Earth Engine (GEE)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#authentication">Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="#datasets">Datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#user-datasets">User Datasets</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#local-data">Local Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#merit-and-hydrobasins">MERIT and HydroBASINS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#user-dataset-configuration">User Dataset Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/notebooks/basic_example.html">Basic example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../issues/index.html">Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apiref/index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">rabpro</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>GEE and Data</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/data/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="gee-and-data">
<span id="data"></span><h1>GEE and Data<a class="headerlink" href="#gee-and-data" title="Permalink to this headline"></a></h1>
<p>RaBPro requires setting up Google Earth Engine and downloading some data files
in order to run. This section describes those requirements, along with some
additional options.</p>
<section id="google-earth-engine-gee">
<h2>Google Earth Engine (GEE)<a class="headerlink" href="#google-earth-engine-gee" title="Permalink to this headline"></a></h2>
<section id="authentication">
<h3>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline"></a></h3>
<p>In order to use RaBPro, you’ll need to sign up for a free GEE account <a class="reference external" href="https://signup.earthengine.google.com/#!/">here</a>. Once you’ve been approved and
installed the GEE Python API (typically installed as a RaBPro dependency), you
can use the GEE CLI to obtain a credential token by running <code class="docutils literal notranslate"><span class="pre">earthengine</span>
<span class="pre">authenticate</span></code> and following the instructions. More information can be found at
the <a class="reference external" href="https://developers.google.com/earth-engine/guides/python_install">GEE Python install page</a> and the
<a class="reference external" href="https://developers.google.com/earth-engine/guides/python_install">GEE CLI page</a>.</p>
</section>
<section id="datasets">
<h3>Datasets<a class="headerlink" href="#datasets" title="Permalink to this headline"></a></h3>
<p>RaBPro uses a JSON file containing metadata for all datasets available through
GEE in order to validate requests to the GEE API and fail fast if they’re
invalid. This JSON file is updated daily server-side. RaBPro caches a local copy
of this file, and will attempt to retrieve an updated version when run or daily
(the less frequent of the two). The file can be found <a class="reference external" href="https://github.com/VeinsOfTheEarth/rabpro/blob/main/Data/gee_datasets.json">here</a>, and
will be downloaded to the following locations:</p>
<p>Linux: <code class="docutils literal notranslate"><span class="pre">~/.local/share/rabpro/</span></code></p>
<p>macOS: <code class="docutils literal notranslate"><span class="pre">~/Library/Application</span> <span class="pre">Support/rabpro/</span></code></p>
<p>Windows: <code class="docutils literal notranslate"><span class="pre">%UserProfile%\AppData\Local\jschwenk\rabpro\</span></code></p>
<p>This file should not be edited manually - any changes will be overwritten when
an updated version is retrieved.</p>
</section>
<section id="user-datasets">
<h3>User Datasets<a class="headerlink" href="#user-datasets" title="Permalink to this headline"></a></h3>
<table class="docutils align-center" id="id1">
<caption><span class="caption-text">Datasets included in the user data catalog:</span><a class="headerlink" href="#id1" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference external" href="https://code.earthengine.google.com/?asset=projects/sat-io/open-datasets/Geomorpho90m/slope">Geomorpho90m: Slope</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://code.earthengine.google.com/?asset=users/jstacompute/FLO1K_qma">FLOW1K qma</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://code.earthengine.google.com/?asset=users/jstacompute/UiO_PEX_PERPROB_5p0_20181128_2000_2016_NH">Northern Hemisphere modeled permafrost probabilities</a></p></td>
</tr>
</tbody>
</table>
<p>You can add custom datasets to GEE by following the instructions <a class="reference external" href="https://developers.google.com/earth-engine/guides/image_upload">here</a>. To ensure
compatibility with RaBPro, upload GeoTIFFs and specify a no-data value if
applicable. In order to use this dataset with RaBPro follow the instructions in
<a class="reference internal" href="#user-dataset-configuration">User Dataset Configuration</a>.</p>
</section>
</section>
<section id="local-data">
<h2>Local Data<a class="headerlink" href="#local-data" title="Permalink to this headline"></a></h2>
<section id="merit-and-hydrobasins">
<h3>MERIT and HydroBASINS<a class="headerlink" href="#merit-and-hydrobasins" title="Permalink to this headline"></a></h3>
<p>RaBPro requires local copies of the <a class="reference external" href="http://hydro.iis.u-tokyo.ac.jp/~yamadai/MERIT_Hydro/">MERIT Hydro</a>, and <a class="reference external" href="https://www.hydrosheds.org/downloads">HydroBASINS</a> datasets to delineate watersheds and
compute elevation profiles.</p>
<p>Specifically, RaBPro needs level one and level twelve shapefiles from
HydroBASINS, and all MERIT tif files for a given tile. These can be installed
manually or programatically through the RaBPro API or CLI.</p>
<p>The data files should be located in the following paths:</p>
<p>Linux: <code class="docutils literal notranslate"><span class="pre">~/.local/share/rabpro/</span></code></p>
<p>macOS: <code class="docutils literal notranslate"><span class="pre">~/Library/Application</span> <span class="pre">Support/rabpro/</span></code></p>
<p>Windows: <code class="docutils literal notranslate"><span class="pre">%UserProfile%\AppData\Local\rabpro\rabpro\</span></code></p>
<p>with the following directory structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>MERIT_Hydro/
├─ MERIT_ELEV_HP/
├─ MERIT_FDR/
├─ MERIT_UDA/
├─ MERIT_WTH/
├─ MERIT103/
HydroBasins/
├─ level_one/
├─ level_twelve/
</pre></div>
</div>
</section>
<section id="user-dataset-configuration">
<h3>User Dataset Configuration<a class="headerlink" href="#user-dataset-configuration" title="Permalink to this headline"></a></h3>
<p>Place (or create) a file <cite>user_gee_datasets.json</cite> at the location returned by:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rabpro</span> <span class="kn">import</span> <span class="n">data_utils</span> <span class="k">as</span> <span class="n">du</span>
<span class="n">du</span><span class="o">.</span><span class="n">_path_generator_util</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>User datasets typically do not have “bands”. To create a valid json entry for such bandless datasets, enter a json block similar to the following:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;projects/sat-io/open-datasets/Geomorpho90m/slope&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Geomorpho90m: Slope&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;start_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;end_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;image_collection&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;bands&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;None&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;resolution&quot;</span><span class="p">:</span><span class="mi">90</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">]</span><span class="w"></span>
</pre></div>
</div>
<p>Call this dataset from <cite>subbasin_stats</cite> without specifying a band:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">,</span> <span class="n">task</span> <span class="o">=</span> <span class="n">rabpro</span><span class="o">.</span><span class="n">subbasin_stats</span><span class="o">.</span><span class="n">main</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">Dataset</span><span class="p">(</span>
            <span class="s2">&quot;projects/sat-io/open-datasets/Geomorpho90m/slope&quot;</span><span class="p">,</span> <span class="n">time_stats</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;median&quot;</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="p">],</span>
    <span class="n">gee_feature_path</span><span class="o">=</span><span class="s2">&quot;your/asset/path&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../background/index.html" class="btn btn-neutral float-left" title="Background" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../examples/notebooks/basic_example.html" class="btn btn-neutral float-right" title="Basic example" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, T. Zussman, J. Schwenk, J. Stachelek, &amp; J. Rowland.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>